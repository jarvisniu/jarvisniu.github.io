<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
    <style type="text/css">
html {background-color: #E8E8E8;padding: 16px;}
body {font-family: Roboto, Corbel, Avenir, 'Lucida Grande', 'Lucida Sans', sans-serif;
    font-size: 14.3999996185303px;font-smoothing: antialiased;background-color: white;max-width: 800px;
    margin: 0 auto;padding: 40px;border: solid 1px #BBB;border-radius: 4px;}
a {color: #6A0E0E;text-decoration: none;border-bottom: 1px dotted #798780;}
a:hover{background: #F1FFF7;}
a:hover{color: #BA2121;}
h1, h2, h3, h4, h5, h6 {font-weight: normal;}
hr {border: none;height: 1px;background-color: #CFE3DC;margin-top: 24px;}
pre {margin: 0px;padding: 20px;border: 1px solid #EAEAEA;
    border-radius: 4px;font-size: 15px;}
code, pre {font-family: Inconsolata, Consolas, Menlo, Monaco, "Courier New", monospace;
    color: #0C4B33;font-size: 1.07em;background-color: rgb(228, 228, 228);}
    </style>
</head>
<body>
<h1 id="excelinput-">ExcelInput 更新</h1>
<p>上次提交的控件，未实现合计功能。这次补充完成。</p>
<h2 id="-">变更文件</h2>
<p>变更了两个文件：<code>BjExcelInput.js</code> 和 <code>ExcelInput-Demo.htm</code>。</p>
<h3 id="bjexcelinput-js-">BjExcelInput.js 更新内容：</h3>
<ul>
<li>添加一个函数：function OnExcelCellChange(ele)</li>
<li>将此函数名作为参数传入iTextInp()</li>
</ul>
<h3 id="excelinput-demo-htm-">ExcelInput-Demo.htm 更新内容：</h3>
<ul>
<li>原来的Cell内填充的都是随机数，现在改为空</li>
<li>原来的合计都是随机数，现在清空为0</li>
</ul>
<h2 id="-">合计原理</h2>
<ol>
<li>获取被修改<code>&lt;td&gt;</code> Element 的兄弟<code>&lt;td&gt;</code>。合计它们的值，记为行合计；</li>
<li>同理，合计被修改<code>&lt;td&gt;</code>同列的<code>&lt;td&gt;</code>，记为列合计；</li>
<li>找到对应的行合计与列合计对应的<code>&lt;td&gt;</code>，将计算结果写入此<code>&lt;td&gt;</code>。</li>
</ol>

</body>
</html>