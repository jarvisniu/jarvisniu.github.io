<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Draw Circle</title>
    <script src="../../lib/za_geom2d.min.js"></script>
    <script src="../../src/Bu.dev.js"></script>
    <script type="text/javascript">
      var renderer;
      var circle, line;
      
      var isButtonDown = false;
      var mousePosDown = new Bu.Point();
      var mousePos = new Bu.Point();
      
      $.ready(init);
      
      function init() {
        // renderer
        renderer = new Bu.Renderer({
          container: "#container"
        });
        // bind events
        renderer.dom.addEventListener("mousedown", onMouseDown);
        renderer.dom.addEventListener("mousemove", onMouseMove);
        renderer.dom.addEventListener("mouseup", onMouseUp);
      }
      
      function onMouseDown(e) {
        // add circle
        mousePosDown.set(e.offsetX, e.offsetY);
      
        circle = new Bu.Circle(mousePosDown.x, mousePosDown.y, 1);
        renderer.append(circle);
      
        line = new Bu.Line(mousePosDown.x, mousePosDown.y, mousePosDown.x, mousePosDown.y);
        line.stroke("#f44");
        renderer.append(line);
      
        isButtonDown = true;
      }
      
      function onMouseMove(e) {
        // change radius
        if (isButtonDown) {
          mousePos.set(e.offsetX, e.offsetY);
          circle.radius = mousePos.distanceTo(mousePosDown);
          line.points[1].copy(mousePos);
        }
      }
      
      function onMouseUp(e) {
        isButtonDown = false;
      }
      
    </script>
  </head>
  <body>
    <div>Drag to draw a circle.</div>
    <div id="container"></div>
  </body>
</html>