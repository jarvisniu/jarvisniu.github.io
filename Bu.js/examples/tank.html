<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Tank 1990</title>
	<script src="../build/bu.js"></script>
	<script type="text/javascript">
		var bu = new Bu.App({
			renderer: {
				width: 512,
				height: 512,
				background: 'black',
				imageSmoothing: false,
			},
			data: {
				font: new Bu.SpriteSheet('assets/sprite-sheets/nes-font.json'),
				sheet: new Bu.SpriteSheet('assets/sprite-sheets/tank.json'),
				highScore1: 0,
				highScore2: 20000,
				scrollAnim: new Bu.Animation({
					duration: 3,
					update: function (anim) {
						return this.position.y = (1 - anim.t) * 512;
					}
				}),
			},
			objects: function () {
				var textHighScoreValue1 = new Bu.PointText(this.highScore1 + "", 32 * 5.5, 32);
				var textHighScoreValue2 = new Bu.PointText(this.highScore2 + "", 32 * 10.5, 32);

				return {
					sceneStart: new Bu.Scene(),
					txtHighScoreTitle1: new Bu.PointText("I-", 32, 32).setAlign('++'),
					txtHighScoreValue1: textHighScoreValue1.setAlign('-+'),
					txtHighScoreTitle2: new Bu.PointText("HI-", 32 * 6, 32).setAlign('++'),
					txtHighScoreValue2: textHighScoreValue2.setAlign('-+'),
					txt1P: new Bu.PointText("1 PLAYER", 32 * 5, 32 * 10).setAlign('++'),
					txt2P: new Bu.PointText("2 PLAYERS", 32 * 5, 32 * 11).setAlign('++'),
					txtConstruction: new Bu.PointText("CONSTRUCTION", 32 * 5, 32 * 12).setAlign('++'),
					txtCopyright: new Bu.PointText("(C) 1990", 32 * 5, 32 * 13.5).setAlign('++'),
					txtAuthor: new Bu.PointText("Recreated By Jarvis Niu", 32 * 2, 32 * 15).setAlign('++'),

					selector: new Bu.Image(null, 32 * 4.2, 32 * 10.25, 32, 32),
				}
			},
			hierarchy: {
				sceneStart: {
					txtHighScoreTitle1: {},
					txtHighScoreValue1: {},
					txtHighScoreTitle2: {},
					txtHighScoreValue2: {},
					txt1P: {},
					txt2P: {},
					txtConstruction: {},
					txtCopyright: {},
					txtAuthor: {},
					selector: {},
				},
			},
			init: function () {
				var o = this.$objects;

				Bu.DEFAULT_FONT = this.font;
				this.sheet.once('loaded', () => {
					o.selector.image = this.sheet.getFrameImage('tank_p1');
				});

				o.sceneStart.animate(this.scrollAnim);
			},
		});
	</script>
</head>
<body>
	<div id="info">This is copy of NES game "Battle City" in 1985.</div>
</body>
</html>
