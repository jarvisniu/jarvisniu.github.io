
/**
 * NetHoneycomb - a net consists of hexagons like a honeycomb.
 * @param w - Width of the honeycomb net.
 * @param h - Height of the honeycomb net.
 * @constructor
 */

(function() {
  AStar.NetHoneycomb = function(w, h) {
    this.engine = null;
    this.nodes = [];
    this.width = w || 15;
    this.height = h || 10;
    this.startNode = null;
    this.endNode = null;
    this.setStart = function(x, y) {
      var node;
      node = this.getNode(x, y);
      this.startNode = node;
      node.state = AStar.NODE_STATE_START;
      this.engine.trigger('nodeChanged', node.position);
    };
    this.setEnd = function(x, y) {
      var node;
      node = this.getNode(x, y);
      this.endNode = node;
      node.state = AStar.NODE_STATE_END;
      this.engine.trigger('nodeChanged', node.position);
    };
    this.getNode = function(x, y) {
      var base;
      (base = this.nodes)[x] || (base[x] = []);
      if (this.nodes[x][y] == null) {
        this.nodes[x][y] = new AStar.Node(this);
        this.nodes[x][y].position.x = x;
        this.nodes[x][y].position.y = y;
      }
      return this.nodes[x][y];
    };
    this.getNeighboursOf = function(node) {
      var i, j, k, l, neighbour, ref, ref1, ref2, ref3, x, xFrom, xTo, y, yFrom, yTo;
      if (node.neighbours != null) {
        return node.neighbours;
      }
      x = node.position.x;
      y = node.position.y;
      xFrom = x - 1;
      xTo = x + 1;
      yFrom = y - 1;
      yTo = y + 1;
      if (xFrom < 0) {
        xFrom = 0;
      }
      if (xFrom > this.width - 1) {
        xFrom = this.width - 1;
      }
      if (xTo < 0) {
        xTo = 0;
      }
      if (xTo > this.width - 1) {
        xTo = this.width - 1;
      }
      if (yFrom < 0) {
        yFrom = 0;
      }
      if (yFrom > this.height - 1) {
        yFrom = this.height - 1;
      }
      if (yTo < 0) {
        yTo = 0;
      }
      if (yTo > this.height - 1) {
        yTo = this.height - 1;
      }
      node.neighbours = [];
      for (i = k = ref = xFrom, ref1 = xTo; ref <= ref1 ? k <= ref1 : k >= ref1; i = ref <= ref1 ? ++k : --k) {
        for (j = l = ref2 = yFrom, ref3 = yTo; ref2 <= ref3 ? l <= ref3 : l >= ref3; j = ref2 <= ref3 ? ++l : --l) {
          neighbour = this.getNode(i, j);
          if (i === x && j === y) {
            continue;
          }
          if (neighbour.state === AStar.NODE_STATE_OBSTACLE) {
            continue;
          }
          if ((i - x) * (j - y) > 0) {
            continue;
          }
          node.neighbours.push(neighbour);
        }
      }
      return node.neighbours;
    };
    this.calcShortestDistance = function(node1, node2) {
      var dx, dy;
      dx = node1.position.x - node2.position.x;
      dy = node1.position.y - node2.position.y;
      if (dx * dy < 0) {
        return Math.abs(Math.abs(dx + dy) + Math.min(Math.abs(dx), Math.abs(dy)));
      } else {
        return Math.abs(dx + dy);
      }
    };
    return this;
  };

}).call(this);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImEtc3Rhci9OZXRIb25leWNvbWIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7OztBQUFBO0VBT0EsS0FBSyxDQUFDLFlBQU4sR0FBcUIsU0FBQyxDQUFELEVBQUksQ0FBSjtJQUNwQixJQUFDLENBQUEsTUFBRCxHQUFVO0lBQ1YsSUFBQyxDQUFBLEtBQUQsR0FBUztJQUVULElBQUMsQ0FBQSxLQUFELEdBQVMsQ0FBQSxJQUFLO0lBQ2QsSUFBQyxDQUFBLE1BQUQsR0FBVSxDQUFBLElBQUs7SUFFZixJQUFDLENBQUEsU0FBRCxHQUFhO0lBQ2IsSUFBQyxDQUFBLE9BQUQsR0FBVztJQUVYLElBQUMsQ0FBQSxRQUFELEdBQVksU0FBQyxDQUFELEVBQUksQ0FBSjtBQUNYLFVBQUE7TUFBQSxJQUFBLEdBQU8sSUFBQyxDQUFBLE9BQUQsQ0FBUyxDQUFULEVBQVksQ0FBWjtNQUNQLElBQUMsQ0FBQSxTQUFELEdBQWE7TUFFYixJQUFJLENBQUMsS0FBTCxHQUFhLEtBQUssQ0FBQztNQUNuQixJQUFDLENBQUEsTUFBTSxDQUFDLE9BQVIsQ0FBZ0IsYUFBaEIsRUFBK0IsSUFBSSxDQUFDLFFBQXBDO0lBTFc7SUFRWixJQUFDLENBQUEsTUFBRCxHQUFVLFNBQUMsQ0FBRCxFQUFJLENBQUo7QUFDVCxVQUFBO01BQUEsSUFBQSxHQUFPLElBQUMsQ0FBQSxPQUFELENBQVMsQ0FBVCxFQUFZLENBQVo7TUFDUCxJQUFDLENBQUEsT0FBRCxHQUFXO01BRVgsSUFBSSxDQUFDLEtBQUwsR0FBYSxLQUFLLENBQUM7TUFDbkIsSUFBQyxDQUFBLE1BQU0sQ0FBQyxPQUFSLENBQWdCLGFBQWhCLEVBQStCLElBQUksQ0FBQyxRQUFwQztJQUxTO0lBUVYsSUFBQyxDQUFBLE9BQUQsR0FBVyxTQUFDLENBQUQsRUFBSSxDQUFKO0FBQ1YsVUFBQTtjQUFBLElBQUMsQ0FBQSxNQUFNLENBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxJQUFPO01BQ2QsSUFBTyx3QkFBUDtRQUNDLElBQUMsQ0FBQSxLQUFNLENBQUEsQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFWLEdBQW1CLElBQUEsS0FBSyxDQUFDLElBQU4sQ0FBVyxJQUFYO1FBQ25CLElBQUMsQ0FBQSxLQUFNLENBQUEsQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFFLENBQUMsUUFBUSxDQUFDLENBQXRCLEdBQTBCO1FBQzFCLElBQUMsQ0FBQSxLQUFNLENBQUEsQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFFLENBQUMsUUFBUSxDQUFDLENBQXRCLEdBQTBCLEVBSDNCOzthQUlBLElBQUMsQ0FBQSxLQUFNLENBQUEsQ0FBQSxDQUFHLENBQUEsQ0FBQTtJQU5BO0lBUVgsSUFBQyxDQUFBLGVBQUQsR0FBbUIsU0FBQyxJQUFEO0FBQ2xCLFVBQUE7TUFBQSxJQUEwQix1QkFBMUI7QUFBQSxlQUFPLElBQUksQ0FBQyxXQUFaOztNQUVBLENBQUEsR0FBSSxJQUFJLENBQUMsUUFBUSxDQUFDO01BQ2xCLENBQUEsR0FBSSxJQUFJLENBQUMsUUFBUSxDQUFDO01BRWxCLEtBQUEsR0FBUSxDQUFBLEdBQUk7TUFDWixHQUFBLEdBQU0sQ0FBQSxHQUFJO01BQ1YsS0FBQSxHQUFRLENBQUEsR0FBSTtNQUNaLEdBQUEsR0FBTSxDQUFBLEdBQUk7TUFFVixJQUFhLEtBQUEsR0FBUSxDQUFyQjtRQUFBLEtBQUEsR0FBUSxFQUFSOztNQUNBLElBQXNCLEtBQUEsR0FBUSxJQUFDLENBQUEsS0FBRCxHQUFTLENBQXZDO1FBQUEsS0FBQSxHQUFRLElBQUMsQ0FBQSxLQUFELEdBQVMsRUFBakI7O01BQ0EsSUFBVyxHQUFBLEdBQU0sQ0FBakI7UUFBQSxHQUFBLEdBQU0sRUFBTjs7TUFDQSxJQUFvQixHQUFBLEdBQU0sSUFBQyxDQUFBLEtBQUQsR0FBUyxDQUFuQztRQUFBLEdBQUEsR0FBTSxJQUFDLENBQUEsS0FBRCxHQUFTLEVBQWY7O01BRUEsSUFBYSxLQUFBLEdBQVEsQ0FBckI7UUFBQSxLQUFBLEdBQVEsRUFBUjs7TUFDQSxJQUF1QixLQUFBLEdBQVEsSUFBQyxDQUFBLE1BQUQsR0FBVSxDQUF6QztRQUFBLEtBQUEsR0FBUSxJQUFDLENBQUEsTUFBRCxHQUFVLEVBQWxCOztNQUNBLElBQVcsR0FBQSxHQUFNLENBQWpCO1FBQUEsR0FBQSxHQUFNLEVBQU47O01BQ0EsSUFBcUIsR0FBQSxHQUFNLElBQUMsQ0FBQSxNQUFELEdBQVUsQ0FBckM7UUFBQSxHQUFBLEdBQU0sSUFBQyxDQUFBLE1BQUQsR0FBVSxFQUFoQjs7TUFFQSxJQUFJLENBQUMsVUFBTCxHQUFrQjtBQUVsQixXQUFTLGlHQUFUO0FBQ0MsYUFBUyxvR0FBVDtVQUNDLFNBQUEsR0FBWSxJQUFDLENBQUEsT0FBRCxDQUFTLENBQVQsRUFBWSxDQUFaO1VBRVosSUFBWSxDQUFBLEtBQUssQ0FBTCxJQUFXLENBQUEsS0FBSyxDQUE1QjtBQUFBLHFCQUFBOztVQUVBLElBQVksU0FBUyxDQUFDLEtBQVYsS0FBbUIsS0FBSyxDQUFDLG1CQUFyQztBQUFBLHFCQUFBOztVQUNBLElBQVksQ0FBQyxDQUFBLEdBQUksQ0FBTCxDQUFBLEdBQVUsQ0FBQyxDQUFBLEdBQUksQ0FBTCxDQUFWLEdBQW9CLENBQWhDO0FBQUEscUJBQUE7O1VBQ0EsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFoQixDQUFxQixTQUFyQjtBQVBEO0FBREQ7YUFTQSxJQUFJLENBQUM7SUFoQ2E7SUFrQ25CLElBQUMsQ0FBQSxvQkFBRCxHQUF3QixTQUFDLEtBQUQsRUFBUSxLQUFSO0FBQ3ZCLFVBQUE7TUFBQSxFQUFBLEdBQUssS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFmLEdBQW9CLEtBQUssQ0FBQyxRQUFRLENBQUM7TUFDeEMsRUFBQSxHQUFLLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBZixHQUFvQixLQUFLLENBQUMsUUFBUSxDQUFDO01BQ3hDLElBQUcsRUFBQSxHQUFLLEVBQUwsR0FBVSxDQUFiO0FBQ0MsZUFBTyxJQUFJLENBQUMsR0FBTCxDQUFTLElBQUksQ0FBQyxHQUFMLENBQVMsRUFBQSxHQUFLLEVBQWQsQ0FBQSxHQUFvQixJQUFJLENBQUMsR0FBTCxDQUFTLElBQUksQ0FBQyxHQUFMLENBQVMsRUFBVCxDQUFULEVBQXVCLElBQUksQ0FBQyxHQUFMLENBQVMsRUFBVCxDQUF2QixDQUE3QixFQURSO09BQUEsTUFBQTtBQUdDLGVBQU8sSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFBLEdBQUssRUFBZCxFQUhSOztJQUh1QjtBQVF4QixXQUFPO0VBNUVhO0FBUHJCIiwiZmlsZSI6ImEtc3Rhci9OZXRIb25leWNvbWIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIjIyMqXHJcbiMgTmV0SG9uZXljb21iIC0gYSBuZXQgY29uc2lzdHMgb2YgaGV4YWdvbnMgbGlrZSBhIGhvbmV5Y29tYi5cclxuIyBAcGFyYW0gdyAtIFdpZHRoIG9mIHRoZSBob25leWNvbWIgbmV0LlxyXG4jIEBwYXJhbSBoIC0gSGVpZ2h0IG9mIHRoZSBob25leWNvbWIgbmV0LlxyXG4jIEBjb25zdHJ1Y3RvclxyXG4jIyNcclxuXHJcbkFTdGFyLk5ldEhvbmV5Y29tYiA9ICh3LCBoKSAtPlxyXG5cdEBlbmdpbmUgPSBudWxsXHJcblx0QG5vZGVzID0gW11cclxuXHJcblx0QHdpZHRoID0gdyBvciAxNVxyXG5cdEBoZWlnaHQgPSBoIG9yIDEwXHJcblxyXG5cdEBzdGFydE5vZGUgPSBudWxsXHJcblx0QGVuZE5vZGUgPSBudWxsXHJcblxyXG5cdEBzZXRTdGFydCA9ICh4LCB5KSAtPlxyXG5cdFx0bm9kZSA9IEBnZXROb2RlKHgsIHkpXHJcblx0XHRAc3RhcnROb2RlID0gbm9kZVxyXG5cclxuXHRcdG5vZGUuc3RhdGUgPSBBU3Rhci5OT0RFX1NUQVRFX1NUQVJUXHJcblx0XHRAZW5naW5lLnRyaWdnZXIgJ25vZGVDaGFuZ2VkJywgbm9kZS5wb3NpdGlvblxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdEBzZXRFbmQgPSAoeCwgeSkgLT5cclxuXHRcdG5vZGUgPSBAZ2V0Tm9kZSh4LCB5KVxyXG5cdFx0QGVuZE5vZGUgPSBub2RlXHJcblxyXG5cdFx0bm9kZS5zdGF0ZSA9IEFTdGFyLk5PREVfU1RBVEVfRU5EXHJcblx0XHRAZW5naW5lLnRyaWdnZXIgJ25vZGVDaGFuZ2VkJywgbm9kZS5wb3NpdGlvblxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdEBnZXROb2RlID0gKHgsIHkpIC0+XHJcblx0XHRAbm9kZXNbeF0gb3I9IFtdXHJcblx0XHRpZiBub3QgQG5vZGVzW3hdW3ldP1xyXG5cdFx0XHRAbm9kZXNbeF1beV0gPSBuZXcgQVN0YXIuTm9kZSB0aGlzXHJcblx0XHRcdEBub2Rlc1t4XVt5XS5wb3NpdGlvbi54ID0geFxyXG5cdFx0XHRAbm9kZXNbeF1beV0ucG9zaXRpb24ueSA9IHlcclxuXHRcdEBub2Rlc1t4XVt5XVxyXG5cclxuXHRAZ2V0TmVpZ2hib3Vyc09mID0gKG5vZGUpIC0+XHJcblx0XHRyZXR1cm4gbm9kZS5uZWlnaGJvdXJzIGlmIG5vZGUubmVpZ2hib3Vycz9cclxuXHJcblx0XHR4ID0gbm9kZS5wb3NpdGlvbi54XHJcblx0XHR5ID0gbm9kZS5wb3NpdGlvbi55XHJcblxyXG5cdFx0eEZyb20gPSB4IC0gMVxyXG5cdFx0eFRvID0geCArIDFcclxuXHRcdHlGcm9tID0geSAtIDFcclxuXHRcdHlUbyA9IHkgKyAxXHJcblxyXG5cdFx0eEZyb20gPSAwIGlmIHhGcm9tIDwgMFxyXG5cdFx0eEZyb20gPSBAd2lkdGggLSAxIGlmIHhGcm9tID4gQHdpZHRoIC0gMVxyXG5cdFx0eFRvID0gMCBpZiB4VG8gPCAwXHJcblx0XHR4VG8gPSBAd2lkdGggLSAxIGlmIHhUbyA+IEB3aWR0aCAtIDFcclxuXHJcblx0XHR5RnJvbSA9IDAgaWYgeUZyb20gPCAwXHJcblx0XHR5RnJvbSA9IEBoZWlnaHQgLSAxIGlmIHlGcm9tID4gQGhlaWdodCAtIDFcclxuXHRcdHlUbyA9IDAgaWYgeVRvIDwgMFxyXG5cdFx0eVRvID0gQGhlaWdodCAtIDEgaWYgeVRvID4gQGhlaWdodCAtIDFcclxuXHJcblx0XHRub2RlLm5laWdoYm91cnMgPSBbXVxyXG5cclxuXHRcdGZvciBpIGluIFt4RnJvbS4ueFRvXVxyXG5cdFx0XHRmb3IgaiBpbiBbeUZyb20uLnlUb11cclxuXHRcdFx0XHRuZWlnaGJvdXIgPSBAZ2V0Tm9kZShpLCBqKVxyXG5cdFx0XHRcdCMgbm90IGl0c2VsZlxyXG5cdFx0XHRcdGNvbnRpbnVlIGlmIGkgPT0geCBhbmQgaiA9PSB5XHJcblx0XHRcdFx0IyBub3Qgb2JzdGFjbGVcclxuXHRcdFx0XHRjb250aW51ZSBpZiBuZWlnaGJvdXIuc3RhdGUgPT0gQVN0YXIuTk9ERV9TVEFURV9PQlNUQUNMRVxyXG5cdFx0XHRcdGNvbnRpbnVlIGlmIChpIC0geCkgKiAoaiAtIHkpID4gMFxyXG5cdFx0XHRcdG5vZGUubmVpZ2hib3Vycy5wdXNoIG5laWdoYm91clxyXG5cdFx0bm9kZS5uZWlnaGJvdXJzXHJcblxyXG5cdEBjYWxjU2hvcnRlc3REaXN0YW5jZSA9IChub2RlMSwgbm9kZTIpIC0+XHJcblx0XHRkeCA9IG5vZGUxLnBvc2l0aW9uLnggLSAobm9kZTIucG9zaXRpb24ueClcclxuXHRcdGR5ID0gbm9kZTEucG9zaXRpb24ueSAtIChub2RlMi5wb3NpdGlvbi55KVxyXG5cdFx0aWYgZHggKiBkeSA8IDBcclxuXHRcdFx0cmV0dXJuIE1hdGguYWJzIE1hdGguYWJzKGR4ICsgZHkpICsgTWF0aC5taW4oTWF0aC5hYnMoZHgpLCBNYXRoLmFicyhkeSkpXHJcblx0XHRlbHNlXHJcblx0XHRcdHJldHVybiBNYXRoLmFicyBkeCArIGR5XHJcblxyXG5cdHJldHVybiB0aGlzXHJcbiJdfQ==
