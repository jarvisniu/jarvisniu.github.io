!function(t,e,i,n){(i=t.createElement("script")).async=1,i.src="//"+(location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",(n=t.getElementsByTagName("script")[0]).parentNode.insertBefore(i,n)}(document);var Bu=function(){"use strict";function t(t){return t instanceof Object&&"Object"===t.constructor.name}function e(t){return t instanceof Array}function i(n){if("object"!==(void 0===n?"undefined":o(n))||null===n||"function"==typeof n)return n;if(n.clone)return n.clone();var s=void 0;s=e(n)?[]:t(n)?{}:Object.create(n.constructor.prototype);for(var r in n)n.hasOwnProperty(r)&&(s[r]=i(n[r]));return s}function n(t,e,i){for(var n=t%360/360,s=i<.5?i*(1+e):i+e-i*e,r=2*i-s,o=[n+1/3,n,n-1/3],a=[],h=[0,1,2],l=0;l<h.length;l++){var u=h[l];o[u]<0&&(o[u]+=1),o[u]>1&&(o[u]-=1)}for(var c=[0,1,2],d=0;d<c.length;d++){var p=c[d];o[p]<1/6?a[p]=r+6*(s-r)*o[p]:o[p]<.5?a[p]=s:o[p]<2/3?a[p]=r+6*(s-r)*(2/3-o[p]):a[p]=r,a[p]=Math.round(255*a[p])}return a}function s(t){return y.clamp(t,0,1)}function r(t){t.keyPoints=t.vertices;var e=t.vertices,i=e.length;if(i>=1&&(t.controlPointsBehind[0]=e[0]),i>=2&&(t.controlPointsAhead[i-1]=e[i-1]),i>=3)for(var n=1;n<i-1;n++){var s=Math.atan2(e[n].y-e[n-1].y,e[n].x-e[n-1].x),r=Math.atan2(e[n+1].y-e[n].y,e[n+1].x-e[n].x),o=y.bevel(e[n].y-e[n-1].y,e[n].x-e[n-1].x),a=y.bevel(e[n].y-e[n+1].y,e[n].x-e[n+1].x),h=s+(r-s)*(t._smoother?o/(o+a):.5);Math.abs(h-s)>y.HALF_PI&&(h+=Math.PI);var l=e[n].x-o*t.smoothFactor*Math.cos(h),u=e[n].y-o*t.smoothFactor*Math.sin(h),c=e[n].x+a*t.smoothFactor*Math.cos(h),d=e[n].y+a*t.smoothFactor*Math.sin(h);t.controlPointsAhead[n]=new G(l,u),t.controlPointsBehind[n]=new G(c,d)}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},c=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){s=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=Math.PI/2,p=2*Math.PI;Function.prototype.property=function(t,e){return Object.defineProperty(this.prototype,t,e)};var y={HALF_PI:d,TWO_PI:p,POINT_RENDER_SIZE:2.25,POINT_LABEL_OFFSET:5,DEFAULT_SPLINE_SMOOTH:.25,DEFAULT_NEAR_DIST:5,MOUSE:{NONE:0,LEFT:1,RIGHT:2,MIDDLE:4},average:function(){var t=arguments;"object"===o(t[0])&&(t=t[0]);var e=0,i=!0,n=!1,s=void 0;try{for(var r,a=t[Symbol.iterator]();!(i=(r=a.next()).done);i=!0)e+=r.value}catch(t){n=!0,s=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}return e/t.length},bevel:function(t,e){return Math.sqrt(t*t+e*e)},clamp:function(t,e,i){return t<e&&(t=e),t>i&&(t=i),t},rand:function(t,e){if(!e){var i=[0,t];t=i[0],e=i[1]}return Math.random()*(e-t)+t},r2d:function(t){return(180*t/Math.PI).toFixed(1)},d2r:function(t){return t*Math.PI/180},now:function(){return window.performance.now()},combineOptions:function(e,i){i||(i={});var n=e[e.length-1];if(t(n))for(var s in n)null!=n[s]&&(i[s]=n[s]);return i},isPlainObject:t,isArray:e,clone:i,throttle:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=0,n=0;return function(){(i=Date.now())-n>1e3*e&&(t.apply(null,arguments),n=i)}},debounce:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=null,n=null,s=function(){t.apply(null,i)};return function(){i=arguments,clearTimeout(n),n=setTimeout(s,1e3*e)}},data:function(t,e){if(!e)return(e=window.localStorage["Bu."+t])?JSON.parse(e):null;window.localStorage["Bu."+t]=JSON.stringify(e)}},f=function(){var t=this,e={};this.on=function(t,i){e[t]=e[t]||[];var n=e[t];-1===n.indexOf(i)&&n.push(i)},this.once=function(e,i){i.once=!0,t.on(e,i)},this.off=function(t,i){var n=e[t];if(i){if(n){var s=n.indexOf(i);s>-1&&n.splice(s,1)}}else n&&(n.length=0)},this.trigger=function(i,n){var s=e[i];if(s){(n=n||{}).target=t;var r=!0,o=!1,a=void 0;try{for(var h,l=s[Symbol.iterator]();!(r=(h=l.next()).done);r=!0){var u=h.value;u.call(t,n),u.once&&s.splice(s.indexOf(u),1)}}catch(t){o=!0,a=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}}}},g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,t),this.x=e,this.y=i}return h(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"offset",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"project",value:function(t){this.x*=t.scale.x,this.y*=t.scale.y;var e=y.bevel(this.x,this.y),i=Math.atan2(this.y,this.x)+t.rotation;return this.x=e*Math.cos(i),this.y=e*Math.sin(i),this.x+=t.position.x,this.y+=t.position.y,this}},{key:"unProject",value:function(t){this.x-=t.position.x,this.y-=t.position.y;var e=y.bevel(this.x,this.y),i=Math.atan2(this.y,this.x)-t.rotation;return this.x=e*Math.cos(i),this.y=e*Math.sin(i),this.x/=t.scale.x,this.y/=t.scale.y,this}}]),t}(),v=function(){function t(e){a(this,t),this.target=e,this.x1=this.y1=this.x2=this.y2=0,this.isEmpty=!0,this.point1=new g,this.point2=new g,this.update(),this.bindEvent()}return h(t,[{key:"containsPoint",value:function(t){return this.x1<t.x&&this.x2>t.x&&this.y1<t.y&&this.y2>t.y}},{key:"update",value:function(){switch(this.clear(),this.target.type){case"Line":case"Triangle":case"Rectangle":var t=!0,e=!1,i=void 0;try{for(var n,s=this.target.points[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var r=n.value;this.expandByPoint(r)}}catch(t){e=!0,i=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw i}}break;case"Circle":case"Bow":case"Fan":this.expandByCircle(this.target);break;case"Polyline":case"Polygon":var o=!0,a=!1,h=void 0;try{for(var l,u=this.target.vertices[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;this.expandByPoint(c)}}catch(t){a=!0,h=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw h}}break;case"Ellipse":this.x1=-this.target.radiusX,this.x2=this.target.radiusX,this.y1=-this.target.radiusY,this.y2=this.target.radiusY;break;default:console.warn("Bu.Bounds: not supported shape type "+this.target.type)}}},{key:"clear",value:function(){return this.x1=this.y1=this.x2=this.y2=0,this.isEmpty=!0,this}},{key:"bindEvent",value:function(){switch(this.target.type){case"Circle":case"Bow":case"Fan":this.target.on("centerChanged",this.update.bind(this)),this.target.on("radiusChanged",this.update.bind(this));break;case"Ellipse":this.target.on("changed",this.update.bind(this))}}},{key:"expandByPoint",value:function(t){return this.isEmpty?(this.isEmpty=!1,this.x1=this.x2=t.x,this.y1=this.y2=t.y):(t.x<this.x1&&(this.x1=t.x),t.x>this.x2&&(this.x2=t.x),t.y<this.y1&&(this.y1=t.y),t.y>this.y2&&(this.y2=t.y)),this}},{key:"expandByCircle",value:function(t){var e=t.center,i=t.radius;return this.isEmpty?(this.isEmpty=!1,this.x1=e.x-i,this.x2=e.x+i,this.y1=e.y-i,this.y2=e.y+i):(e.x-i<this.x1&&(this.x1=e.x-i),e.x+i>this.x2&&(this.x2=e.x+i),e.y-i<this.y1&&(this.y1=e.y-i),e.y+i>this.y2&&(this.y2=e.y+i)),this}}]),t}(),m=function t(){return this.strokeStyle=t.DEFAULT_STROKE_STYLE,this.fillStyle=t.DEFAULT_FILL_STYLE,this.dashStyle=!1,this.dashFlowSpeed=0,this.lineWidth=1,this.dashOffset=0,this.style=function(t){"string"==typeof t?(t=L.styles[t])||(t=L.styles.default,console.warn("Styled: Bu.styles."+t+" doesn't exists, fell back to default.")):t||(t=L.styles.default);for(var e=["strokeStyle","fillStyle","dashStyle","dashFlowSpeed","lineWidth"],i=0;i<e.length;i++){var n=e[i];this[n]=t[n]}return this},this.stroke=function(e){switch(null==e&&(e=!0),L.styles&&e in L.styles&&(e=L.styles[e].strokeStyle),e){case!0:this.strokeStyle=t.DEFAULT_STROKE_STYLE;break;case!1:this.strokeStyle=null;break;default:this.strokeStyle=e}return this},this.fill=function(e){switch(null==e&&(e=!0),L.styles&&e in L.styles&&(e=L.styles[e].fillStyle),e){case!1:this.fillStyle=null;break;case!0:this.fillStyle=t.DEFAULT_FILL_STYLE;break;default:this.fillStyle=e}return this},this.dash=function(e){switch(null==e?e=!0:L.styles&&e in L.styles?e=L.styles[e].dashStyle:"number"==typeof e&&(e=[e,e]),e){case!1:this.dashStyle=null;break;case!0:this.dashStyle=t.DEFAULT_DASH_STYLE;break;default:this.dashStyle=e}return this},this.dashFlow=function(t){return!0===t||null==t?t=1:!1===t&&(t=0),L.dashFlowManager.setSpeed(this,t),this},this.setLineWidth=function(t){return this.lineWidth=t,this},this};m.DEFAULT_STROKE_STYLE="#048",m.DEFAULT_FILL_STYLE="rgba(64, 128, 192, 0.5)",m.DEFAULT_DASH_STYLE=[8,4];var x=function(){function t(){a(this,t),m.apply(this),f.apply(this),this.visible=!0,this.opacity=1,this.position=new g,this.rotation=0,this._scale=new g(1,1),this.skew=new g,this.bounds=null,this.keyPoints=null,this.children=[],this.parent=null}return h(t,[{key:"translate",value:function(t,e){return this.position.x+=t,this.position.y+=e,this}},{key:"rotate",value:function(t){return this.rotation+=t,this}},{key:"scaleBy",value:function(t){return this.scale*=t,this}},{key:"scaleTo",value:function(t){return this.scale=t,this}},{key:"getScene",value:function(){for(var t=this;"Scene"!==t.type;)t=t.parent;return t}},{key:"addChild",value:function(t){if(y.isArray(t)){var e=!0,i=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value;this.children.push(o),o.parent=this}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}}else this.children.push(t),t.parent=this;return this}},{key:"removeChild",value:function(t){var e=this.children.indexOf(t);return e>-1&&this.children.splice(e,1),this}},{key:"animate",value:function(t,e){if(y.isArray(e)||(e=[e]),"string"==typeof t)t in L.animations?L.animations[t].applyTo(this,e):console.warn('Bu.animations["'+t+"\"] doesn't exists.");else if(y.isArray(t))for(var i in t)t.hasOwnProperty(i)&&this.animate(t[i],e);else t.applyTo(this,e);return this}},{key:"createBounds",value:function(){return this.bounds=new v(this),this}},{key:"hitTest",value:function(t){var e=this.getScene().renderer;return t.set.apply(t,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(e.projectToWorld(t.x,t.y))),t.project(e.camera),t.unProject(this),this.containsPoint(t)}},{key:"containsPoint",value:function(t){return!(this.bounds&&!this.bounds.containsPoint(t))&&(!!this._containsPoint&&this._containsPoint(t))}}]),t}();x.prototype.type="Object2D",x.prototype.fillable=!1,x.property("scale",{get:function(){return this._scale},set:function(t){return"number"==typeof t?(this._scale.x=this._scale.y=t,this):(this._scale=t,this)}});var w,b=function(t){function e(){a(this,e);var t=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.type="Camera",t}return l(e,x),e}(),k=function(t){function e(){a(this,e);var t=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.type="Scene",t.background=Bu.config.background,t.renderer=null,t}return l(e,x),e}();(w=function(){var t=function(){function t(){var e=this;a(this,t);var i,n,s,r,o,h,l,u,c,d;for(this.drawShapes=this.drawShapes.bind(this),this.drawShape=this.drawShape.bind(this),f.apply(this),this.type="Renderer",this.scene=new k(this),this.camera=new b,this.tickCount=0,this.isRunning=!0,this.pixelRatio=window.devicePixelRatio||1,"undefined"!=typeof ClipMeter&&null!==ClipMeter&&(this.clipMeter=new ClipMeter),u=y.combineOptions(arguments,{container:"body",showBounds:!1,imageSmoothing:!0}),r=0,o=(c=["container","width","height","showBounds"]).length;r<o;r++)this[h=c[r]]=u[h];this.fillParent="number"!=typeof u.width,this.pixelWidth=this.width*this.pixelRatio,this.pixelHeight=this.height*this.pixelRatio,this.dom=document.createElement("canvas"),this.dom.style.cursor=L.config.cursor,this.dom.style.boxSizing="content-box",this.dom.oncontextmenu=function(){return!1},this.context=this.dom.getContext("2d"),this.context.textBaseline="top","string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.fillParent&&this.container===document.body&&(s=document.querySelector("html"),(n=document.querySelector("body")).style.margin="0",n.style.overflow="hidden",s.style.width=s.style.height=n.style.width=n.style.height="100%"),l=function(){var t,i;return t=e.dom.height/e.dom.width,(i=e.container.clientHeight/e.container.clientWidth)<t?(e.height=e.container.clientHeight,e.width=e.height/i):(e.width=e.container.clientWidth,e.height=e.width*i),e.pixelWidth=e.dom.width=e.width*e.pixelRatio,e.pixelHeight=e.dom.height=e.height*e.pixelRatio,e.dom.style.width=e.width+"px",e.dom.style.height=e.height+"px",e.render()},this.fillParent?(this.pixelWidth=this.container.clientWidth,this.pixelHeight=this.container.clientHeight,this.width=this.pixelWidth/this.pixelRatio,this.height=this.pixelHeight/this.pixelRatio,window.addEventListener("resize",l),this.dom.addEventListener("DOMNodeInserted",l)):(this.dom.style.width=this.width+"px",this.dom.style.height=this.height+"px",this.dom.width=this.pixelWidth,this.dom.height=this.pixelHeight),(d=function(){return e.isRunning&&(null!=e.clipMeter&&e.clipMeter.start(),e.render(),e.trigger("update",e),e.tickCount+=1,null!=e.clipMeter&&e.clipMeter.tick()),requestAnimationFrame(d)})(),i=function(){return e.container.appendChild(e.dom),e.imageSmoothing=u.imageSmoothing},setTimeout(i,1),L.animationRunner.hookUp(this),L.dashFlowManager.hookUp(this)}return h(t,[{key:"pause",value:function(){return this.isRunning=!1}},{key:"continue",value:function(){return this.isRunning=!0}},{key:"toggle",value:function(){return this.isRunning=!this.isRunning}},{key:"projectToWorld",value:function(t,e){return L.config.originAtCenter?[t-this.width/2,e-this.height/2]:[t,e]}},{key:"render",value:function(){return this.context.save(),this.clearCanvas(),L.config.originAtCenter&&this.context.translate(this.pixelWidth/2,this.pixelHeight/2),this.context.scale(this.pixelRatio,this.pixelRatio),this.context.scale(1/this.camera.scale.x,1/this.camera.scale.y),this.context.rotate(-this.camera.rotation),this.context.translate(-this.camera.position.x,-this.camera.position.y),this.drawShape(this.scene),this.context.restore(),this}},{key:"clearCanvas",value:function(){return this.context.fillStyle=this.scene.background,this.context.fillRect(0,0,this.pixelWidth,this.pixelHeight),this}},{key:"drawShapes",value:function(t){var e,i,n;if(null!=t)for(e=0,i=t.length;e<i;e++)n=t[e],this.context.save(),this.drawShape(n),this.context.restore();return this}},{key:"drawShape",value:function(t){var e,i,n;if(!t.visible)return this;switch(this.context.translate(t.position.x,t.position.y),this.context.rotate(t.rotation),i=t.scale.x,n=t.scale.y,(i/n>100||i/n<.01)&&(Math.abs(i)<.02&&(i=0),Math.abs(n)<.02&&(n=0)),this.context.scale(i,n),this.context.globalAlpha*=t.opacity,null!=t.strokeStyle&&(this.context.strokeStyle=t.strokeStyle,this.context.lineWidth=t.lineWidth,null!=t.lineCap&&(this.context.lineCap=t.lineCap),null!=t.lineJoin&&(this.context.lineJoin=t.lineJoin)),this.context.beginPath(),t.type){case"Point":this.drawPoint(t);break;case"Line":this.drawLine(t);break;case"Circle":this.drawCircle(t);break;case"Ellipse":this.drawEllipse(t);break;case"Triangle":this.drawTriangle(t);break;case"Rectangle":this.drawRectangle(t);break;case"Fan":this.drawFan(t);break;case"Bow":this.drawBow(t);break;case"Polygon":this.drawPolygon(t);break;case"Polyline":this.drawPolyline(t);break;case"Spline":this.drawSpline(t);break;case"PointText":this.drawPointText(t);break;case"Image":this.drawImage(t);break;case"Object2D":case"Scene":break;default:console.log("drawShapes(): unknown shape: ",t.type,t)}return null!=t.fillStyle&&t.fillable&&(this.context.fillStyle=t.fillStyle,this.context.fill()),t.dashStyle?(this.context.lineDashOffset=t.dashOffset,"function"==typeof(e=this.context).setLineDash&&e.setLineDash(t.dashStyle),this.context.stroke(),this.context.setLineDash([])):null!=t.strokeStyle&&this.context.stroke(),null!=t.children&&this.drawShapes(t.children),L.config.showKeyPoints&&this.drawShapes(t.keyPoints),this.showBounds&&null!=t.bounds&&this.drawBounds(t.bounds),this}},{key:"drawPoint",value:function(t){return this.context.arc(t.x,t.y,y.POINT_RENDER_SIZE,0,y.TWO_PI),this}},{key:"drawLine",value:function(t){return this.context.moveTo(t.points[0].x,t.points[0].y),this.context.lineTo(t.points[1].x,t.points[1].y),this}},{key:"drawCircle",value:function(t){return this.context.arc(t.cx,t.cy,t.radius,0,y.TWO_PI),this}},{key:"drawEllipse",value:function(t){return this.context.ellipse(0,0,t.radiusX,t.radiusY,0,y.TWO_PI,!1),this}},{key:"drawTriangle",value:function(t){return this.context.lineTo(t.points[0].x,t.points[0].y),this.context.lineTo(t.points[1].x,t.points[1].y),this.context.lineTo(t.points[2].x,t.points[2].y),this.context.closePath(),this}},{key:"drawRectangle",value:function(t){return 0!==t.cornerRadius?this.drawRoundRectangle(t):(this.context.rect(t.pointLT.x,t.pointLT.y,t.size.width,t.size.height),this)}},{key:"drawRoundRectangle",value:function(t){var e,i,n,s,r,o;return n=t.pointLT.x,s=t.pointRB.x,r=t.pointLT.y,o=t.pointRB.y,i=t.cornerRadius,this.context.moveTo(n,r+i),this.context.arcTo(n,r,n+i,r,i),this.context.lineTo(s-i,r),this.context.arcTo(s,r,s,r+i,i),this.context.lineTo(s,o-i),this.context.arcTo(s,o,s-i,o,i),this.context.lineTo(n+i,o),this.context.arcTo(n,o,n,o-i,i),this.context.closePath(),null!=t.strokeStyle&&t.dashStyle&&"function"==typeof(e=this.context).setLineDash&&e.setLineDash(t.dashStyle),this}},{key:"drawFan",value:function(t){return this.context.arc(t.cx,t.cy,t.radius,t.aFrom,t.aTo),this.context.lineTo(t.cx,t.cy),this.context.closePath(),this}},{key:"drawBow",value:function(t){return this.context.arc(t.cx,t.cy,t.radius,t.aFrom,t.aTo),this.context.closePath(),this}},{key:"drawPolygon",value:function(t){var e,i,n,s;for(e=0,i=(s=t.vertices).length;e<i;e++)n=s[e],this.context.lineTo(n.x,n.y);return this.context.closePath(),this}},{key:"drawPolyline",value:function(t){var e,i,n,s;for(e=0,i=(s=t.vertices).length;e<i;e++)n=s[e],this.context.lineTo(n.x,n.y);return this}},{key:"drawSpline",value:function(t){var e,i,n,s;if(null!=t.strokeStyle)if(2===(n=t.vertices.length))this.context.moveTo(t.vertices[0].x,t.vertices[0].y),this.context.lineTo(t.vertices[1].x,t.vertices[1].y);else if(n>2)for(this.context.moveTo(t.vertices[0].x,t.vertices[0].y),e=i=1,s=n-1;1<=s?i<=s:i>=s;e=1<=s?++i:--i)this.context.bezierCurveTo(t.controlPointsBehind[e-1].x,t.controlPointsBehind[e-1].y,t.controlPointsAhead[e].x,t.controlPointsAhead[e].y,t.vertices[e].x,t.vertices[e].y);return this}},{key:"drawPointText",value:function(t){var e,i,n,s,r,o,a,h,l;if("string"==typeof(n=t.font||L.config.font))this.context.textAlign=t.textAlign,this.context.textBaseline=t.textBaseline,this.context.font=n,null!=t.strokeStyle&&this.context.strokeText(t.text,t.x,t.y),null!=t.fillStyle&&(this.context.fillStyle=t.fillStyle,this.context.fillText(t.text,t.x,t.y));else if(n instanceof L.SpriteSheet&&n.ready)for(a=n.measureTextWidth(t.text),h=function(){switch(t.textAlign){case"left":return 0;case"center":return-a/2;case"right":return-a}}(),l=function(){switch(t.textBaseline){case"top":return 0;case"middle":return-n.height/2;case"bottom":return-n.height}}(),s=r=0,o=t.text.length;0<=o?r<o:r>o;s=0<=o?++r:--r)e=t.text[s],null!=(i=n.getFrameImage(e))?(this.context.drawImage(i,t.x+h,t.y+l),h+=i.width):h+=10;return this}},{key:"drawImage",value:function(t){var e,i,n,s;return t.ready&&(s=t.size.width,n=t.size.height,e=-s*t.pivot.x,i=-n*t.pivot.y,this.context.drawImage(t.image,e,i,s,n)),this}},{key:"drawBounds",value:function(e){var i;return this.context.beginPath(),this.context.strokeStyle=t.BOUNDS_STROKE_STYLE,"function"==typeof(i=this.context).setLineDash&&i.setLineDash(t.BOUNDS_DASH_STYLE),this.context.rect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),this.context.stroke(),this}}]),t}();return t.property("imageSmoothing",{get:function(){return this._imageSmoothing},set:function(t){return this._imageSmoothing=this.context.imageSmoothingEnabled=t}}),t}()).BOUNDS_STROKE_STYLE="red",w.BOUNDS_DASH_STYLE=[6,6];var P=w,T=function(){function t(){var e=this;a(this,t),this.keyStates=[],window.addEventListener("keydown",function(t){e.keyStates[t.keyCode]=!0}),window.addEventListener("keyup",function(t){e.keyStates[t.keyCode]=!1})}return h(t,[{key:"isKeyDown",value:function(t){var e=this.keyToKeyCode(t);return this.keyStates[e]}},{key:"keyToKeyCode",value:function(t){return t=_[t]||t,S[t]}},{key:"handleAppEvents",value:function(t,e){var i=this,n={},s={};return window.addEventListener("keydown",function(e){n[e.keyCode]&&n[e.keyCode].call(t,e)}),window.addEventListener("keyup",function(e){s[e.keyCode]&&s[e.keyCode].call(t,e)}),function(){var r=[];for(var o in e){var a,h;["mousedown","mousemove","mouseup","mousewheel"].includes(o)?r.push(t.$renderer.dom.addEventListener(o,e[o].bind(t))):["keydown","keyup"].includes(o)?r.push(window.addEventListener(o,e[o].bind(t))):0===o.indexOf("keydown.")?(a=o.substring(8),h=i.keyToKeyCode(a),r.push(n[h]=e[o])):0===o.indexOf("keyup.")?(a=o.substring(6),h=i.keyToKeyCode(a),r.push(s[h]=e[o])):r.push(void 0)}return r}()}}]),t}(),S={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Escape:27," ":32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,",":188,"-":189,".":190,"/":191,";":186,"'":222,"[":219,"]":221,"\\":220},_={Ctrl:"Control",Ctl:"Control",Esc:"Escape",Space:" ",PgUp:"PageUp","Page Up":"PageUp",PgDn:"PageDown","Page Down":"PageDown",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete"},L=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.$options=e;for(var i=["renderer","data","objects","methods","events"],n=0;n<i.length;n++){var s=i[n];this.$options[s]=this.$options[s]||{}}this.$options.el&&(this.$options.renderer.container=this.$options.el),this.$inputManager=new T,function(t,e,i){"complete"===document.readyState?t.apply(e,i):document.addEventListener("DOMContentLoaded",function(){t.apply(e,i)})}(this.init,this),t.$bues.push(this)}return h(t,[{key:"init",value:function(){var t=this,e=arguments,i=new k;this.$renderer=new P(this.$options.renderer),this.$renderer.scene=i,i.renderer=this.$renderer,"function"==typeof this.$options.data&&(this.$options.data=this.$options.data.apply(this));for(var n in this.$options.data)this[n]=this.$options.data[n];for(var s in this.$options.methods)this[s]=this.$options.methods[s];var r="function"==typeof this.$options.objects?this.$options.objects.apply(this):this.$options.objects;for(var o in r)this[o]=r[o];if(!this.$options.scene){this.$options.scene={};for(var a in r)this.$options.scene[a]={}}!function t(e,i){var n=[];for(var s in e)e.hasOwnProperty(s)&&(i.addChild(r[s]),n.push(t(e[s],r[s])));return n}(this.$options.scene,this.$renderer.scene),this.$options.init&&this.$options.init.call(this),this.$inputManager.handleAppEvents(this,this.$options.events),this.$options.update&&this.$renderer.on("update",function(){t.$options.update.apply(t,e)})}}]),t}(),O=function(){var t,e,i=function(){function i(){a(this,i),this.runningAnimations=[]}return h(i,[{key:"add",value:function(t){return t.init(),t.animation.isLegal()?(t.startTime=y.now(),this.runningAnimations.push(t)):console.error("AnimationRunner: animation setting is illegal: ",t.animation)}},{key:"update",value:function(){var i,n,s,r,o,a,h,l,u,c;for(o=y.now(),l=[],s=0,r=(a=this.runningAnimations).length;s<r;s++)(c=a[s]).finished||(i=c.animation,(u=(o-c.startTime)/(1e3*i.duration))>=1&&(n=!0,i.repeat?(u=0,c.startTime=y.now()):(u=1,c.finished=!0)),!0===i.easing?u=e[t](u):null!=e[i.easing]&&(u=e[i.easing](u)),c.t=u,c.interpolate(),i.update.call(c.target,c),n?l.push(null!=(h=i.finish)?h.call(c.target,c):void 0):l.push(void 0));return l}},{key:"hookUp",value:function(t){var e=this;return t.on("update",function(){return e.update()})}}]),i}();return t="quad",e={quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quad:function(t){return t<.5?2*t*t:-2*t*t+4*t-1},cubicIn:function(t){return Math.pow(t,3)},cubicOut:function(t){return Math.pow(t-1,3)+1},cubic:function(t){return t<.5?4*Math.pow(t,3):4*Math.pow(t-1,3)+1},sineIn:function(t){return Math.sin((t-1)*y.HALF_PI)+1},sineOut:function(t){return Math.sin(t*y.HALF_PI)},sine:function(t){return t<.5?(Math.sin((2*t-1)*y.HALF_PI)+1)/2:Math.sin((t-.5)*Math.PI)/2+.5}},i}(),F=function(){function t(){a(this,t),this.flowingObjects=[]}return h(t,[{key:"setSpeed",value:function(t,e){var i;if(t.dashFlowSpeed=e,i=this.flowingObjects.indexOf(t),0!==e){if(-1===i)return this.flowingObjects.push(t)}else if(i>-1)return this.flowingObjects.splice(i,1)}},{key:"update",value:function(){var t,e,i,n,s;for(s=[],t=0,e=(n=this.flowingObjects).length;t<e;t++)i=n[t],s.push(i.dashOffset+=i.dashFlowSpeed);return s}},{key:"hookUp",value:function(t){var e=this;return t.on("update",function(){return e.update()})}}]),t}(),I=/hsl\(\s*(\d+),\s*(\d+)%,\s*(\d+)%\s*\)/i,E=/hsla\(\s*(\d+),\s*(\d+)%,\s*(\d+)%\s*,\s*([.\d]+)\s*\)/i,A=/rgb\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)/i,C=/rgba\(\s*(\d+),\s*(\d+),\s*(\d+)\s*,\s*([.\d]+)\s*\)/i,R=/rgb\(\s*(\d+)%,\s*(\d+)%,\s*(\d+)%\s*\)/i,M=/rgba\(\s*(\d+)%,\s*(\d+)%,\s*(\d+)%\s*,\s*([.\d]+)\s*\)/i,B=/#([0-9A-F]{3})\s*$/i,z=/#([0-9A-F]{6})\s*$/i,D={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},j=function(){function t(){if(a(this,t),this.r=this.g=this.b=255,this.a=1,1===arguments.length){var e=arguments[0];"string"==typeof e?(this.parse(e),this.a=s(this.a)):e instanceof t&&this.copy(e)}else this.r=arguments[0],this.g=arguments[1],this.b=arguments[2],this.a=arguments[3]||1}return h(t,[{key:"parse",value:function(t){var e=t.match(A);if(e)return this.r=+e[1],this.g=+e[2],this.b=+e[3],this.a=1,this;if(e=t.match(I)){var i=n(+e[1],+e[2]/100,+e[3]/100),s=c(i,3),r=s[0],o=s[1],a=s[2];return this.r=r,this.g=o,this.b=a,this.a=1,this}if(e=t.match(C))return this.r=+e[1],this.g=+e[2],this.b=+e[3],this.a=+e[4],this;if(e=t.match(E)){var h=n(+e[1],+e[2]/100,+e[3]/100),l=c(h,3),u=l[0],d=l[1],p=l[2];return this.r=u,this.g=d,this.b=p,this.a=parseFloat(e[4]),this}if(e=t.match(M))return this.r=255*+e[1]/100,this.g=255*+e[2]/100,this.b=255*+e[3]/100,this.a=+e[4],this;if(e=t.match(R))return this.r=255*+e[1]/100,this.g=255*+e[2]/100,this.b=255*+e[3]/100,this.a=1,this;if(e=t.match(B)){var y=e[1];return this.r=parseInt(y[0],16),this.r=16*this.r+this.r,this.g=parseInt(y[1],16),this.g=16*this.g+this.g,this.b=parseInt(y[2],16),this.b=16*this.b+this.b,this.a=1,this}if(e=t.match(z)){var f=e[1];return this.r=parseInt(f.substring(0,2),16),this.g=parseInt(f.substring(2,4),16),this.b=parseInt(f.substring(4,6),16),this.a=1,this}return t=t.toLowerCase().trim(),null!=D[t]?(this.r=D[t][0],this.g=D[t][1],this.b=D[t][2],this.a=D[t][3],null==this.a&&(this.a=1),this):(console.error('Color.parse("'+t+'") error.'),this)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"copy",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setRGB",value:function(t,e,i){return this.r=parseInt(t),this.g=parseInt(e),this.b=parseInt(i),this.a=1,this}},{key:"setRGBA",value:function(t,e,i,n){return this.r=parseInt(t),this.g=parseInt(e),this.b=parseInt(i),this.a=s(parseFloat(n)),this}},{key:"toRGB",value:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"}},{key:"toRGBA",value:function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}]),t}(),W={}.hasOwnProperty,N=function(){var t,e,i,n=function(){function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];a(this,n),this.animation=t,this.target=e,this.args=i,this.startTime=0,this.finished=!1,this.from=y.clone(this.animation.from),this.current=y.clone(this.animation.from),this.to=y.clone(this.animation.to),this.data={},this.t=0,this.arg=this.args[0]}return h(n,[{key:"init",value:function(){var t;return null!=(t=this.animation.init)&&t.call(this.target,this),this.current=y.clone(this.from)}},{key:"restart",value:function(){return this.startTime=y.now(),this.finished=!1}},{key:"end",value:function(){return this.startTime=y.now()-1e3*this.animation.duration}},{key:"interpolate",value:function(){var n,s,r;if(null!=this.from){if("number"==typeof this.from)return this.current=e(this.from,this.to,this.t);if(this.from instanceof j)return t(this.from,this.to,this.t,this.current);if(this.from instanceof g)return i(this.from,this.to,this.t,this.current);if(y.isPlainObject(this.from)){s=this.from,r=[];for(n in s)W.call(s,n)&&("number"==typeof this.from[n]?r.push(this.current[n]=e(this.from[n],this.to[n],this.t)):r.push(interpolateObject(this.from[n],this.to[n],this.t,this.current[n])));return r}return console.error("Animation not support interpolate type: ",this.from)}}}]),n}();return e=function(t,e,i){return e*i-t*(i-1)},t=function(t,i,n,s){return s.setRGBA(e(t.r,i.r,n),e(t.g,i.g,n),e(t.b,i.b,n),e(t.a,i.a,n))},i=function(t,i,n,s){return s.x=e(t.x,i.x,n),s.y=e(t.y,i.y,n)},n}(),Y={}.hasOwnProperty,$=function(){function t(e){a(this,t),this.from=e.from,this.to=e.to,this.duration=e.duration||.5,this.easing=e.easing||!1,this.repeat=!!e.repeat,this.init=e.init,this.update=e.update,this.finish=e.finish}return h(t,[{key:"applyTo",value:function(t,e){var i;return y.isArray(e)||(e=[e]),i=new N(this,t,e),L.animationRunner.add(i),i}},{key:"isLegal",value:function(){var t,e;if(null==this.from||null==this.to)return!0;if(y.isPlainObject(this.from)){e=this.from;for(t in e)if(Y.call(e,t)&&null==this.to[t])return!1}else if(null==this.to)return!1;return!0}}]),t}();L.$bues=[],L.animationRunner=new O,L.dashFlowManager=new F,L.styles={default:(new m).stroke().fill(),hover:(new m).stroke("hsla(0, 100%, 40%, 0.75)").fill("hsla(0, 100%, 75%, 0.5)"),text:(new m).stroke(!1).fill("black"),line:(new m).fill(!1),selected:(new m).setLineWidth(2),dash:(new m).dash()},L.animations={fadeIn:new $({update:function(t){this.opacity=t.t}}),fadeOut:new $({update:function(t){this.opacity=1-t.t}}),spin:new $({update:function(t){this.rotation=t.t*Math.PI*2}}),spinIn:new $({init:function(t){t.data.desScale=t.arg||1},update:function(t){this.opacity=t.t,this.rotation=t.t*Math.PI*4,this.scale=t.t*t.data.desScale}}),spinOut:new $({update:function(t){this.opacity=1-t.t,this.rotation=t.t*Math.PI*4,this.scale=1-t.t}}),blink:new $({duration:.2,from:0,to:512,update:function(t){var e=Math.floor(Math.abs(t.current-256));this.fillStyle="rgb("+e+", "+e+", "+e+")"}}),shake:new $({init:function(t){t.data.ox=this.position.x,t.data.range=t.arg||20},update:function(t){this.position.x=Math.sin(t.t*Math.PI*8)*t.data.range+t.data.ox}}),jump:new $({init:function(t){t.data.oy=this.position.y,t.data.height=t.arg||100},update:function(t){this.position.y=-t.data.height*Math.sin(t.t*Math.PI)+t.data.oy}}),puff:new $({duration:.15,init:function(t){t.from={opacity:this.opacity,scale:this.scale.x},t.to=1===this.opacity?{opacity:0,scale:1.5*this.scale.x}:{opacity:1,scale:this.scale.x/1.5}},update:function(t){this.opacity=t.current.opacity,this.scale=t.current.scale}}),clip:new $({init:function(t){0!==this.scale.y?(t.from=this.scale.y,t.to=0):(t.from=this.scale.y,t.to=this.scale.x)},update:function(t){this.scale.y=t.current}}),flipX:new $({init:function(t){t.from=this.scale.x,t.to=-t.from},update:function(t){this.scale.x=t.current}}),flipY:new $({init:function(t){t.from=this.scale.y,t.to=-t.from},update:function(t){this.scale.y=t.current}}),moveTo:new $({init:function(t){null!=t.arg?(t.from=this.position.x,t.to=parseFloat(t.arg)):console.error("Bu:animations.moveTo need an argument")},update:function(t){this.position.x=t.current}}),moveBy:new $({init:function(t){null!=t.args?(t.from=this.position.x,t.to=this.position.x+parseFloat(t.args)):console.error("Bu:animations.moveBy need an argument")},update:function(t){this.position.x=t.current}}),discolor:new $({init:function(t){var e=t.arg;"string"==typeof e&&(e=new j(e)),t.from=new j(this.fillStyle),t.to=e},update:function(t){this.fillStyle=t.current.toRGBA()}})};var X,H,U=function(){function t(e,i){a(this,t),this.type="Size",this.width=e,this.height=i}return h(t,[{key:"set",value:function(t,e){this.width=t,this.height=e}}]),t}(),q=function(){function t(e){a(this,t),this.audio=document.createElement("audio"),this.url="",this.ready=!1,e&&this.load(e)}return h(t,[{key:"load",value:function(t){var e=this;this.url=t,this.audio.addEventListener("canplay",function(){e.ready=!0}),this.audio.src=t}},{key:"play",value:function(){this.ready?this.audio.play():console.warn("The audio file ["+this.url+"] is not ready.")}}]),t}();X="Verdana",H=12;var K=function(){var t=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,e);var s,r=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.text=t,r.x=i,r.y=n,r.type="PointText",r.strokeStyle=null,r.fillStyle="black",s=y.combineOptions(arguments,{align:"00"}),r.align=s.align,null!=s.font?r.font=s.font:null!=s.fontFamily||null!=s.fontSize?(r._fontFamily=s.fontFamily||X,r._fontSize=s.fontSize||H,r.font=r._fontSize+"px "+r._fontFamily):r.font=null,r}return l(e,x),h(e,[{key:"setAlign",value:function(t){var e,i;return 1===t.length&&(t=""+t+t),e=t.substring(0,1),i=t.substring(1,2),this.textAlign=function(){switch(e){case"-":return"right";case"0":return"center";case"+":return"left"}}(),this.textBaseline=function(){switch(i){case"-":return"bottom";case"0":return"middle";case"+":return"top"}}(),this}},{key:"setFontFamily",value:function(t){return this.fontFamily=t,this}},{key:"setFontSize",value:function(t){return this.fontSize=t,this}}]),e}();return t.property("align",{get:function(){return this._align},set:function(t){return this._align=t,this.setAlign(this._align)}}),t.property("fontFamily",{get:function(){return this._fontFamily},set:function(t){return this._fontFamily=t,this.font=this._fontSize+"px "+this._fontFamily}}),t.property("fontSize",{get:function(){return this._fontSize},set:function(t){return this._fontSize=t,this.font=this._fontSize+"px "+this._fontFamily}}),t}(),G=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,e);var n=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.x=t,n.y=i,n.lineWidth=.5,n._labelIndex=-1,n}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Point",this.prototype.fillable=!0,this.property("label",{get:function(){return this._labelIndex>-1?this.children[this._labelIndex].text:""},set:function(t){if(-1===this._labelIndex){var e=new K(t,this.x+y.POINT_LABEL_OFFSET,this.y,{align:"+0"});this.children.push(e),this._labelIndex=this.children.length-1}else this.children[this._labelIndex].text=t}})}}]),h(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"arcTo",value:function(t,i){return new e(this.x+Math.cos(i)*t,this.y+Math.sin(i)*t)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.updateLabel(),this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this.updateLabel(),this}},{key:"setLabel",value:function(t){return this.label=t,this.updateLabel(),this}},{key:"updateLabel",value:function(){return this._labelIndex>-1&&(this.children[this._labelIndex].x=this.x+y.POINT_LABEL_OFFSET,this.children[this._labelIndex].y=this.y),this}}]),e}();G.initClass();var V=function(t){function e(t,i,n,s){a(this,e);var r=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return arguments.length<2?r.points=[new G,new G]:arguments.length<4?r.points=[t.clone(),i.clone()]:r.points=[new G(t,i),new G(n,s)],r.length=0,r.midpoint=new G,r.keyPoints=r.points,r.on("changed",function(){return r.length=r.points[0].distanceTo(r.points[1]),r.midpoint.set((r.points[0].x+r.points[1].x)/2,(r.points[0].y+r.points[1].y)/2)}),r.trigger("changed"),r}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Line",this.prototype.fillable=!1}}]),h(e,[{key:"clone",value:function(){return new e(this.points[0],this.points[1])}},{key:"set",value:function(t,e,i,n){return null!=n?(this.points[0].set(t,e),this.points[1].set(i,n)):(this.points[0]=t,this.points[1]=e),this.trigger("changed"),this}},{key:"setPoint1",value:function(t,e){return null!=e?this.points[0].set(t,e):this.points[0].copy(t),this.trigger("changed"),this}},{key:"setPoint2",value:function(t,e){return null!=e?this.points[1].set(t,e):this.points[1].copy(t),this.trigger("changed"),this}}]),e}();V.initClass();var J=function(t){function e(t,i,n,s,r){a(this,e);var o=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(o.cx=t,o.cy=i,o.radius=n,o.aFrom=s,o.aTo=r,o.aFrom>o.aTo){var h=[o.aTo,o.aFrom];o.aFrom=h[0],o.aTo=h[1]}return o.center=new G(o.cx,o.cy),o.string=new V(o.center.arcTo(o.radius,o.aFrom),o.center.arcTo(o.radius,o.aTo)),o.keyPoints=o.string.points,o.updateKeyPoints(),o.on("changed",o.updateKeyPoints),o.on("changed",function(){null!=o.bounds&&o.bounds.update()}),o}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Bow",this.prototype.fillable=!0}}]),h(e,[{key:"clone",value:function(){return new e(this.cx,this.cy,this.radius,this.aFrom,this.aTo)}},{key:"updateKeyPoints",value:function(){return this.center.set(this.cx,this.cy),this.string.points[0].copy(this.center.arcTo(this.radius,this.aFrom)),this.string.points[1].copy(this.center.arcTo(this.radius,this.aTo)),this.keyPoints=this.string.points,this}}]),e}();J.initClass();var Z=function(t){function e(t,i,n){a(this,e);var s=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return null==t&&(t=1),s._radius=t,null==i&&(i=0),null==n&&(n=0),s._center=new G(i,n),s.bounds=null,s.keyPoints=[s._center],s.on("centerChanged",s.updateKeyPoints),s}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Circle",this.prototype.fillable=!0,this.property("cx",{get:function(){return this._center.x},set:function(t){return this._center.x=t,this.trigger("centerChanged",this)}}),this.property("cy",{get:function(){return this._center.y},set:function(t){return this._center.y=t,this.trigger("centerChanged",this)}}),this.property("center",{get:function(){return this._center},set:function(t){return this._center=t,this.cx=t.x,this.cy=t.y,this.keyPoints[0]=t,this.trigger("centerChanged",this)}}),this.property("radius",{get:function(){return this._radius},set:function(t){return this._radius=t,this.trigger("radiusChanged",this),this}})}}]),h(e,[{key:"clone",value:function(){return new e(this.radius,this.cx,this.cy)}},{key:"updateKeyPoints",value:function(){return this.keyPoints[0].set(this.cx,this.cy)}}]),e}();Z.initClass();var Q=function(t){function e(t,i){a(this,e);var n=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return null==t&&(t=20),n._radiusX=t,null==i&&(i=10),n._radiusY=i,n}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Ellipse",this.prototype.fillable=!0,this.property("radiusX",{get:function(){return this._radiusX},set:function(t){return this._radiusX=t,this.trigger("changed",this)}}),this.property("radiusY",{get:function(){return this._radiusY},set:function(t){return this._radiusY=t,this.trigger("changed",this)}})}}]),e}();Q.initClass();var tt=function(t){function e(t,i,n,s,r){a(this,e);var o=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(o.cx=t,o.cy=i,o.radius=n,o.aFrom=s,o.aTo=r,o.aFrom>o.aTo){var h=[o.aTo,o.aFrom];o.aFrom=h[0],o.aTo=h[1]}return o.center=new G(o.cx,o.cy),o.string=new V(o.center.arcTo(o.radius,o.aFrom),o.center.arcTo(o.radius,o.aTo)),o.keyPoints=[o.string.points[0],o.string.points[1],o.center],o.on("changed",o.updateKeyPoints),o.on("changed",function(){null!=o.bounds&&o.bounds.update()}),o}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Fan",this.prototype.fillable=!0}}]),h(e,[{key:"clone",value:function(){return new e(this.cx,this.cy,this.radius,this.aFrom,this.aTo)}},{key:"updateKeyPoints",value:function(){return this.center.set(this.cx,this.cy),this.string.points[0].copy(this.center.arcTo(this.radius,this.aFrom)),this.string.points[1].copy(this.center.arcTo(this.radius,this.aTo)),this}}]),e}();tt.initClass();var et=function(t){function e(t,i,n){a(this,e);var s=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(6===arguments.length){var r=Array.from(arguments),o=c(r,6),h=o[0],l=o[1],d=o[2],p=o[3],y=o[4],f=o[5];t=new G(h,l),i=new G(d,p),n=new G(y,f)}return s.lines=[new V(t,i),new V(i,n),new V(n,t)],s.points=[t,i,n],s.keyPoints=s.points,s.on("changed",s.update),s.on("changed",function(){null!=s.bounds&&s.bounds.update()}),s}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Triangle",this.prototype.fillable=!0}}]),h(e,[{key:"clone",value:function(){return new e(this.points[0],this.points[1],this.points[2])}},{key:"update",value:function(){this.lines[0].points[0].copy(this.points[0]),this.lines[0].points[1].copy(this.points[1]),this.lines[1].points[0].copy(this.points[1]),this.lines[1].points[1].copy(this.points[2]),this.lines[2].points[0].copy(this.points[2]),this.lines[2].points[1].copy(this.points[0])}}]),e}();et.initClass();var it=function(t){function e(t){a(this,e);var i=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i.vertices=[],i.lines=[],i.triangles=[];var n=y.combineOptions(arguments,{angle:0});if(y.isArray(t))null!=t&&(i.vertices=t);else{var s=void 0,r=void 0,o=void 0,h=void 0;arguments.length<4?(o=0,h=0,r=arguments[0],s=arguments[1]):(o=arguments[0],h=arguments[1],r=arguments[2],s=arguments[3]),i.vertices=e.generateRegularPoints(o,h,r,s,n)}return i.onVerticesChanged(),i.on("changed",i.onVerticesChanged),i.on("changed",function(){null!=i.bounds&&i.bounds.update()}),i.keyPoints=i.vertices,i}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Polygon",this.prototype.fillable=!0}}]),h(e,[{key:"clone",value:function(){return new e(this.vertices)}},{key:"onVerticesChanged",value:function(){if(this.lines=[],this.triangles=[],this.vertices.length>1){for(var t=0;t<this.vertices.length-1;t++)this.lines.push(new V(this.vertices[t],this.vertices[t+1]));this.lines.push(new V(this.vertices[this.vertices.length-1],this.vertices[0]))}if(this.vertices.length>2)for(var e=1;e<this.vertices.length-1;e++)this.triangles.push(new et(this.vertices[0],this.vertices[e],this.vertices[e+1]))}},{key:"isSimple",value:function(){for(var t=this.lines.length,e=0;e<t;e++)for(var i=e+1;e<t;e++)if(this.lines[e].isCrossWithLine(this.lints[i]))return!1;return!0}},{key:"addPoint",value:function(t,e){return null!=e?this.vertices.splice(e,0,t):(this.vertices.push(t),this.vertices.length>1&&(this.lines[this.lines.length-1].points[1]=t),this.vertices.length>0&&this.lines.push(new V(this.vertices[this.vertices.length-1],this.vertices[0])),this.vertices.length>2?this.triangles.push(new et(this.vertices[0],this.vertices[this.vertices.length-2],this.vertices[this.vertices.length-1])):void 0)}}],[{key:"generateRegularPoints",value:function(t,e,i,n,s){for(var r=s.angle,o=i,a=[],h=y.TWO_PI/n,l=0;l<n;l++){var u=l*h+r,c=t+o*Math.cos(u),d=e+o*Math.sin(u);a[l]=new G(c,d)}return a}}]),e}();it.initClass();var nt=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a(this,e);var i=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(i.vertices=t,arguments.length>1){t=[];for(var n=0;n<arguments.length/2;n++)t.push(new G(arguments[2*n],arguments[2*n+1]));i.vertices=t}return i.lines=[],i.keyPoints=i.vertices,i.fill(!1),i.on("changed",function(){i.vertices.length>1&&(i.updateLines(),"function"==typeof i.calcLength&&i.calcLength(),"function"==typeof i.calcPointNormalizedPos&&i.calcPointNormalizedPos())}),i.trigger("changed"),i}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Polyline",this.prototype.fillable=!1}}]),h(e,[{key:"clone",value:function(){var t=new e(this.vertices);return t.strokeStyle=this.strokeStyle,t.fillStyle=this.fillStyle,t.dashStyle=this.dashStyle,t.lineWidth=this.lineWidth,t.dashOffset=this.dashOffset,t}},{key:"updateLines",value:function(){for(var t=0,e=this.vertices.length-1,i=e>=0;i?t<e:t>e;i?t++:t--)null!=this.lines[t]?this.lines[t].set(this.vertices[t],this.vertices[t+1]):this.lines[t]=new V(this.vertices[t],this.vertices[t+1]);return this}},{key:"set",value:function(t){for(var e=0;e<this.vertices.length;e++)this.vertices[e].copy(t[e]);return this.vertices.length>t.length&&this.vertices.splice(t.length),this.trigger("changed"),this}},{key:"addPoint",value:function(t,e){return null==e?(this.vertices.push(t),this.vertices.length>1&&this.lines.push(new V(this.vertices[this.vertices.length-2],this.vertices[this.vertices.length-1]))):this.vertices.splice(e,0,t),this.trigger("changed"),this}}]),e}();nt.initClass();var st=function(t){function e(t,i,n,s){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;a(this,e);var o=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.center=new G(t+n/2,i+s/2),o.size=new U(n,s),o.pointLT=new G(t,i),o.pointRT=new G(t+n,i),o.pointRB=new G(t+n,i+s),o.pointLB=new G(t,i+s),o.points=[o.pointLT,o.pointRT,o.pointRB,o.pointLB],o.cornerRadius=r,o.on("changed",function(){null!=o.bounds&&o.bounds.update()}),o}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Rectangle",this.prototype.fillable=!0,this.property("cornerRadius",{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius=t,this.keyPoints=t>0?[]:this.points}})}}]),h(e,[{key:"clone",value:function(){return new e(this.pointLT.x,this.pointLT.y,this.size.width,this.size.height)}},{key:"set",value:function(t,e,i,n){return this.center.set(t+i/2,e+n/2),this.size.set(i,n),this.pointLT.set(t,e),this.pointRT.set(t+i,e),this.pointRB.set(t+i,e+n),this.pointLB.set(t,e+n)}}]),e}();st.initClass();var rt=function(t){function e(t){a(this,e);var i=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(t instanceof nt){var n=t;i.vertices=n.vertices,n.on("pointChange",function(t){return i.vertices=t.vertices,r(i)})}else i.vertices=y.clone(t);return i.keyPoints=i.vertices,i.controlPointsAhead=[],i.controlPointsBehind=[],i.fill(!1),i.smoothFactor=y.DEFAULT_SPLINE_SMOOTH,i._smoother=!1,r(i),i}return l(e,x),h(e,null,[{key:"initClass",value:function(){this.prototype.type="Spline",this.prototype.fillable=!1,this.property("smoother",{get:function(){return this._smoother},set:function(t){var e=this._smoother;if(this._smoother=t,e!==this._smoother)return r(this)}})}}]),h(e,[{key:"clone",value:function(){return new e(this.vertices)}},{key:"addPoint",value:function(t){return this.vertices.push(t),r(this)}}]),e}();rt.initClass();var ot,at=function(){var t=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments[3],r=arguments[4];a(this,e);var o=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.url=t,o.type="Image",o.autoSize=!0,o.size=new U,o.position=new g(i,n),o.center=new g(i+s/2,n+r/2),null!=s&&(o.size.set(s,r),o.autoSize=!1),o.pivot=new g(.5,.5),o._image=new window.Image,o.ready=!1,o._image.onload=function(t){return o.autoSize&&o.size.set(o._image.width,o._image.height),o.ready=!0},null!=o.url&&(o._image.src=o.url),o}return l(e,x),e}();return t.property("image",{get:function(){return this._image},set:function(t){return this._image=t,this.ready=!0}}),t}(),ht={}.hasOwnProperty;ot=function(t,e){var i;return e||("object"===(void 0===t?"undefined":o(t))?t=(e=t).url:e={}),e.method||(e.method="GET"),null==e.async&&(e.async=!0),i=new XMLHttpRequest,i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){if(null!=e.success)return e.success(i.responseText,i.status,i)}else if(null!=e.error&&e.error(i,i.status),null!=e.complete)return e.complete(i,i.status)},i.open(e.method,t,e.async,e.username,e.password),i.send(null)};var lt,ut,ct=function(){var t,e,i,n=function(){function t(e){var i=this;a(this,t),this.url=e,f.apply(this),this.ready=!1,this.height=0,this.data=null,this.images=[],this.frameImages=[],ot(this.url,{success:function(t){var e,n,s,r,o;i.data=JSON.parse(t),null==i.data.images&&(i.data.images=[i.url.substring(i.url.lastIndexOf("/"),i.url.length-5)+".png"]),e=i.url.substring(0,i.url.lastIndexOf("/")+1),r=i.data.images,o=[];for(s in r)ht.call(r,s)&&(i.data.images[s]=e+i.data.images[s],n=0,i.images[s]=new Image,i.images[s].onload=function(){if((n+=1)===i.data.images.length)return i.parseData()},o.push(i.images[s].src=i.data.images[s]));return o}})}return h(t,[{key:"parseData",value:function(){var t,i,n,s,r,o,a,h,l,u;i=this.data.frames;for(s in i)if(ht.call(i,s)){for(r=o=0;o<=4;r=++o)null==i[s][r]&&(i[s][r]=null!=(null!=(a=i[s-1])?a[r]:void 0)?i[s-1][r]:0);l=i[s][0],u=i[s][1],h=i[s][2],n=i[s][3],t=i[s][4],this.frameImages[s]=e(this.images[t],l,u,h,n),0===this.height&&(this.height=n)}return this.ready=!0,this.trigger("loaded")}},{key:"getFrameImage",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.ready?null==(e=this.data.animations[t])?null:this.frameImages[e.frames[i]]:null}},{key:"measureTextWidth",value:function(t){var e,i,n,s;for(s=0,i=0,n=t.length;i<n;i++)e=t[i],s+=this.getFrameImage(e).width;return s}}]),t}();return t=document.createElement("canvas"),i=t.getContext("2d"),e=function(e,n,s,r,o){var a;return t.width=r,t.height=o,i.drawImage(e,n,s,r,o,0,0,r,o),a=new Image,a.src=t.toDataURL(),a},n}(),dt=function(){function t(e){a(this,t),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this),this.renderer=e,this.camera=this.renderer.camera,this.zoomScaleAnim=pt.applyTo(this.camera),this.zoomTransAnim=yt.applyTo(this.camera),this.smoothZooming=!0,this.desScale=new g(1,1),this.renderer.dom.addEventListener("mousemove",this.onMouseMove),this.renderer.dom.addEventListener("mousewheel",this.onMouseWheel)}return h(t,[{key:"onMouseMove",value:function(t){if(t.buttons===y.MOUSE.LEFT){var e=this.camera.scale.x,i=-t.movementX*e,n=-t.movementY*e;return this.camera.translate(i,n)}}},{key:"onMouseWheel",value:function(t){var e=Array.from(this.renderer.projectToWorld(t.offsetX,t.offsetY)),i=c(e,2),n=i[0],s=i[1],r=Math.pow(1.25,-t.wheelDelta/120);this.desScale.multiplyScalar(r);var o=this.desScale.x/this.camera.scale.x,a=-n*(o-1)*this.camera.scale.x,h=-s*(o-1)*this.camera.scale.y;return this.smoothZooming?(this.zoomScaleAnim.from.copy(this.camera.scale),this.zoomScaleAnim.to.copy(this.desScale),this.zoomScaleAnim.restart(),this.zoomTransAnim.from.copy(this.camera.position),this.zoomTransAnim.to.set(this.camera.position.x+a,this.camera.position.y+h),this.zoomTransAnim.restart()):(this.camera.translate(a,h),this.camera.scale.copy(this.desScale))}}]),t}(),pt=new $({duration:.2,init:function(t){null==t.arg&&(t.arg=1),t.from=this.scale.clone(),t.to=this.scale.clone().multiplyScalar(parseFloat(t.arg))},update:function(t){this.scale=t.current}}),yt=new $({duration:.2,init:function(t){null==t.arg&&(t.arg=new g),t.from=this.position.clone(),t.to=this.position.clone().add(t.arg)},update:function(t){this.position.copy(t.current)}}),ft=[].indexOf,gt={}.hasOwnProperty;ut=lt={inject:function(){return this.injectInto(["point","line","circle","ellipse","triangle","rectangle","fan","bow","polygon","polyline"])},injectInto:function(t){if("string"==typeof t&&(t=[t]),ft.call(t,"point")>=0&&(G.prototype.inCircle=function(t){return lt.pointInCircle(this,t)},G.prototype.distanceTo=function(t){return lt.distanceFromPointToPoint(this,t)},G.prototype.isNear=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.DEFAULT_NEAR_DIST;switch(t.type){case"Point":return lt.pointNearPoint(this,t,e);case"Line":return lt.pointNearLine(this,t,e);case"Polyline":return lt.pointNearPolyline(this,t,e)}},G.interpolate=lt.interpolateBetweenTwoPoints),ft.call(t,"line")>=0&&(V.prototype.distanceTo=function(t){return lt.distanceFromPointToLine(t,this)},V.prototype.isTwoPointsSameSide=function(t,e){return lt.twoPointsSameSideOfLine(t,e,this)},V.prototype.footPointFrom=function(t,e){return lt.footPointFromPointToLine(t,this,e)},V.prototype.getCrossPointWith=function(t){return lt.getCrossPointOfTwoLines(t,this)},V.prototype.isCrossWithLine=function(t){return lt.isTwoLinesCross(t,this)},st.prototype.intersectRect=function(t){return lt.isLineIntersectRect(this,t)}),ft.call(t,"circle")>=0&&(Z.prototype._containsPoint=function(t){return lt.pointInCircle(t,this)}),ft.call(t,"ellipse")>=0&&(Q.prototype._containsPoint=function(t){return lt.pointInEllipse(t,this)}),ft.call(t,"triangle")>=0&&(et.prototype._containsPoint=function(t){return lt.pointInTriangle(t,this)},et.prototype.area=function(){return lt.calcTriangleArea(this)}),ft.call(t,"rectangle")>=0&&(st.prototype.containsPoint=function(t){return lt.pointInRectangle(t,this)},st.prototype.intersectLine=function(t){return lt.isLineIntersectRect(t,this)}),ft.call(t,"fan")>=0&&(tt.prototype._containsPoint=function(t){return lt.pointInFan(t,this)}),ft.call(t,"bow")>=0&&(J.prototype._containsPoint=function(t){return lt.pointInBow(t,this)}),ft.call(t,"polygon")>=0&&(it.prototype._containsPoint=function(t){return lt.pointInPolygon(t,this)}),ft.call(t,"polyline")>=0)return nt.prototype.length=0,nt.prototype.pointNormalizedPos=[],nt.prototype.calcLength=function(){return this.length=lt.calcPolylineLength(this)},nt.prototype.calcPointNormalizedPos=function(){return lt.calcNormalizedVerticesPosOfPolyline(this)},nt.prototype.getNormalizedPos=function(t){return null!=t?this.pointNormalizedPos[t]:this.pointNormalizedPos},nt.prototype.compress=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8;return lt.compressPolyline(this,t)}},pointNearPoint:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.DEFAULT_NEAR_DIST;return t.distanceTo(e)<i},pointNearLine:function(t,e){var i,n,s,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.DEFAULT_NEAR_DIST;return r=e.distanceTo(t),i=e.footPointFrom(t),n=i.distanceTo(e.points[0])<e.length+o,s=i.distanceTo(e.points[1])<e.length+o,r<o&&n&&s},pointNearPolyline:function(t,e){var i,n,s,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.DEFAULT_NEAR_DIST;for(i=0,n=(r=e.lines).length;i<n;i++)if(s=r[i],lt.pointNearLine(t,s,o))return!0;return!1},pointInCircle:function(t,e){var i,n;return i=t.x-e.cx,n=t.y-e.cy,y.bevel(i,n)<e.radius},pointInEllipse:function(t,e){return y.bevel(t.x/e.radiusX,t.y/e.radiusY)<1},pointInRectangle:function(t,e){return t.x>e.pointLT.x&&t.y>e.pointLT.y&&t.x<e.pointLT.x+e.size.width&&t.y<e.pointLT.y+e.size.height},pointInTriangle:function(t,e){return lt.twoPointsSameSideOfLine(t,e.points[2],e.lines[0])&&lt.twoPointsSameSideOfLine(t,e.points[0],e.lines[1])&&lt.twoPointsSameSideOfLine(t,e.points[1],e.lines[2])},pointInFan:function(t,e){var i,n,s;for(n=t.x-e.cx,s=t.y-e.cy,i=Math.atan2(t.y-e.cy,t.x-e.cx);i<e.aFrom;)i+=y.TWO_PI;return y.bevel(n,s)<e.radius&&i>e.aFrom&&i<e.aTo},pointInBow:function(t,e){var i,n;return y.bevel(e.cx-t.x,e.cy-t.y)<e.radius&&(i=e.string.isTwoPointsSameSide(e.center,t),n=e.aTo-e.aFrom<Math.PI,i^n)},pointInPolygon:function(t,e){var i,n,s;for(i=0,n=(s=e.triangles).length;i<n;i++)if(s[i].containsPoint(t))return!0;return!1},distanceFromPointToPoint:function(t,e){return y.bevel(t.x-e.x,t.y-e.y)},distanceFromPointToLine:function(t,e){var i,n,s,r;return s=e.points[0],r=e.points[1],i=(s.y-r.y)/(s.x-r.x),n=s.y-i*s.x,Math.abs(i*t.x+n-t.y)/Math.sqrt(i*i+1)},interpolateBetweenTwoPoints:function(t,e,i,n){var s,r;return s=t.x+(e.x-t.x)*i,r=t.y+(e.y-t.y)*i,null!=n?n.set(s,r):new G(s,r)},twoPointsSameSideOfLine:function(t,e,i){var n,s,r,o;return n=i.points[0],s=i.points[1],n.x===s.x?(t.x-n.x)*(e.x-n.x)>0:(r=(n.y-s.y)*(t.x-n.x)/(n.x-s.x)+n.y,o=(n.y-s.y)*(e.x-n.x)/(n.x-s.x)+n.y,(t.y-r)*(e.y-o)>0)},footPointFromPointToLine:function(t,e){var i,n,s,r,o,a,h,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new G;return r=e.points[0],o=e.points[1],i=(r.y-o.y)/(r.x-o.x),n=r.y-i*r.x,s=t.x+i*t.y,a=(s-i*n)/(i*i+1),h=i*a+n,l.set(a,h),l},getCrossPointOfTwoLines:function(t,e){var i,n,s,r,o,a,h,l,u,d,p,y=c(t.points,2);l=y[0],u=y[1];var f=c(e.points,2);return d=f[0],p=f[1],i=u.y-l.y,s=l.x-u.x,o=i*l.x+s*l.y,n=p.y-d.y,r=d.x-p.x,a=n*d.x+r*d.y,h=i*r-n*s,new G((r*o-s*a)/h,(i*a-n*o)/h)},isTwoLinesCross:function(t,e){var i,n,s,r,o,a,h,l,u,c,d;return s=t.points[0].x,l=t.points[0].y,r=t.points[1].x,u=t.points[1].y,o=e.points[0].x,c=e.points[0].y,a=e.points[1].x,d=e.points[1].y,0!=(i=(u-l)*(a-o)-(d-c)*(r-s))&&(n=((r-s)*(a-o)*(c-l)+(u-l)*(a-o)*s-(d-c)*(r-s)*o)/i,h=((u-l)*(d-c)*(o-s)+(r-s)*(d-c)*l-(a-o)*(u-l)*c)/-i,(n-s)*(n-r)<=0&&(n-o)*(n-a)<=0&&(h-l)*(h-u)<=0&&(h-c)*(h-d)<=0)},isLineIntersectRect:function(t,e){var i;return(i=[new V,new V,new V,new V])[0].set(e.points[0],e.points[1]),i[1].set(e.points[1],e.points[2]),i[2].set(e.points[2],e.points[3]),i[3].set(e.points[3],e.points[0]),lt.isTwoLinesCross(t,i[0])||lt.isTwoLinesCross(t,i[1])||lt.isTwoLinesCross(t,i[2])||lt.isTwoLinesCross(t,i[3])},calcPolylineLength:function(t){var e,i,n,s;if(n=0,t.vertices.length>=2)for(e=i=1,s=t.vertices.length;1<=s?i<s:i>s;e=1<=s?++i:--i)n+=t.vertices[e].distanceTo(t.vertices[e-1]);return n},calcNormalizedVerticesPosOfPolyline:function(t){var e,i,n,s,r;for(e=0,t.pointNormalizedPos[0]=0,r=[],i=n=1,s=t.vertices.length;1<=s?n<s:n>s;i=1<=s?++n:--n)e+=t.vertices[i].distanceTo(t.vertices[i-1])/t.length,r.push(t.pointNormalizedPos[i]=e);return r},compressPolyline:function(t,e){var i,n,s,r,o,a;i=[],a=t.vertices;for(n in a)if(gt.call(a,n))if(n<2)i[n]=t.vertices[n];else{var h=i.slice(-2),l=c(h,2);s=l[0],o=l[1],r=t.vertices[n],Math.abs(Math.atan2(s.y-o.y,s.x-o.x)-Math.atan2(o.y-r.y,o.x-r.x))<e*e*y.HALF_PI?i[i.length-1]=r:i.push(r)}return t.vertices=i,t.keyPoints=t.vertices,t},calcTriangleArea:function(t){var e,i,n,s=c(t.points,3);return e=s[0],i=s[1],n=s[2],Math.abs((i.x-e.x)*(n.y-e.y)-(n.x-e.x)*(i.y-e.y))/2}},lt.inject();var vt=ut,mt=function(){var t,e=function(){function e(){a(this,e)}return h(e,[{key:"randomX",value:function(){return y.rand(this.rangeX+t,this.rangeX+this.rangeWidth-2*t)}},{key:"randomY",value:function(){return y.rand(this.rangeY+t,this.rangeY+this.rangeHeight-2*t)}},{key:"randomRadius",value:function(){return y.rand(10,Math.min(this.rangeX+this.rangeWidth,this.rangeY+this.rangeHeight)/2)}},{key:"setRange",value:function(t,e,i,n){return null!=i?(this.rangeX=t,this.rangeY=e,this.rangeWidth=i,this.rangeHeight=n):(this.rangeWidth=t,this.rangeHeight=e),this}},{key:"generate",value:function(t){switch(t){case"circle":return this.generateCircle();case"bow":return this.generateBow();case"triangle":return this.generateTriangle();case"rectangle":return this.generateRectangle();case"fan":return this.generateFan();case"polygon":return this.generatePolygon();case"line":return this.generateLine();case"polyline":return this.generatePolyline();default:return console.warn("not support shape: "+t)}}},{key:"randomize",value:function(t){var e,i,n;if(y.isArray(t))for(e=0,i=t.length;e<i;e++)n=t[e],this.randomize(n);else switch(t.type){case"Circle":this.randomizeCircle(t);break;case"Ellipse":this.randomizeEllipse(t);break;case"Bow":this.randomizeBow(t);break;case"Triangle":this.randomizeTriangle(t);break;case"Rectangle":this.randomizeRectangle(t);break;case"Fan":this.randomizeFan(t);break;case"Polygon":this.randomizePolygon(t);break;case"Line":this.randomizeLine(t);break;case"Polyline":this.randomizePolyline(t);break;default:console.warn("not support shape: "+t.type)}return this}},{key:"randomizePosition",value:function(t){return t.position.x=this.randomX(),t.position.y=this.randomY(),t.trigger("changed"),this}},{key:"generateCircle",value:function(){var t;return t=new Z(this.randomRadius(),this.randomX(),this.randomY()),t.center.label="O",t}},{key:"randomizeCircle",value:function(t){return t.cx=this.randomX(),t.cy=this.randomY(),t.radius=this.randomRadius(),this}},{key:"generateEllipse",value:function(){var t;return t=new Q(this.randomRadius(),this.randomRadius()),this.randomizePosition(t),t}},{key:"randomizeEllipse",value:function(t){return t.radiusX=this.randomRadius(),t.radiusY=this.randomRadius(),this.randomizePosition(t),this}},{key:"generateBow",value:function(){var t,e,i;return t=y.rand(y.TWO_PI),e=t+y.rand(y.HALF_PI,y.TWO_PI),i=new J(this.randomX(),this.randomY(),this.randomRadius(),t,e),i.string.points[0].label="A",i.string.points[1].label="B",i}},{key:"randomizeBow",value:function(t){var e,i;return e=y.rand(y.TWO_PI),i=e+y.rand(y.HALF_PI,y.TWO_PI),t.cx=this.randomX(),t.cy=this.randomY(),t.radius=this.randomRadius(),t.aFrom=e,t.aTo=i,t.trigger("changed"),this}},{key:"generateFan",value:function(){var t,e,i;return t=y.rand(y.TWO_PI),e=t+y.rand(y.HALF_PI,y.TWO_PI),i=new tt(this.randomX(),this.randomY(),this.randomRadius(),t,e),i.center.label="O",i.string.points[0].label="A",i.string.points[1].label="B",i}},{key:"generateTriangle",value:function(){var t,e,i,n;for(i=[],t=e=0;e<=2;t=++e)i[t]=new G(this.randomX(),this.randomY());return n=new et(i[0],i[1],i[2]),n.points[0].label="A",n.points[1].label="B",n.points[2].label="C",n}},{key:"randomizeTriangle",value:function(t){var e,i;for(e=i=0;i<=2;e=++i)t.points[e].set(this.randomX(),this.randomY());return t.trigger("changed"),this}},{key:"generateRectangle",value:function(){var t;return t=new st(y.rand(this.rangeX+this.rangeWidth),y.rand(this.rangeY+this.rangeHeight),y.rand(this.rangeWidth/2),y.rand(this.rangeHeight/2)),t.pointLT.label="A",t.pointRT.label="B",t.pointRB.label="C",t.pointLB.label="D",t}},{key:"randomizeRectangle",value:function(t){return t.set(this.randomX(),this.randomY(),this.randomRadius(),this.randomRadius()),t.trigger("changed"),this}},{key:"generatePolygon",value:function(){var t,e,i,n;for(n=[],t=e=0;e<=3;t=++e)(i=new G(this.randomX(),this.randomY())).label="P"+t,n.push(i);return new it(n)}},{key:"randomizePolygon",value:function(t){var e,i,n;for(e=0,i=(n=t.vertices).length;e<i;e++)n[e].set(this.randomX(),this.randomY());return t.trigger("changed"),this}},{key:"generateLine",value:function(){var t;return t=new V(this.randomX(),this.randomY(),this.randomX(),this.randomY()),t.points[0].label="A",t.points[1].label="B",t}},{key:"randomizeLine",value:function(t){var e,i,n;for(e=0,i=(n=t.points).length;e<i;e++)n[e].set(this.randomX(),this.randomY());return t.trigger("changed"),this}},{key:"generatePolyline",value:function(){var t,e,i,n;for(n=new nt,t=e=0;e<=3;t=++e)(i=new G(this.randomX(),this.randomY())).label="P"+t,n.addPoint(i);return n}},{key:"randomizePolyline",value:function(t){var e,i,n;for(e=0,i=(n=t.vertices).length;e<i;e++)n[e].set(this.randomX(),this.randomY());return t.trigger("changed"),this}}]),e}();return t=30,e.prototype.rangeX=0,e.prototype.rangeY=0,e.prototype.rangeWidth=800,e.prototype.rangeHeight=450,e.prototype.randomizeFan=e.prototype.randomizeBow,e}(),xt={originAtCenter:!0,font:"12px Verdana",background:"#eee",showKeyPoints:!1},wt="default";Object.defineProperty(xt,"cursor",{get:function(){return wt},set:function(t){wt=t;var e=!0,i=!1,n=void 0;try{for(var s,r=L.$bues[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){s.value.$renderer.dom.style.cursor=wt}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}}});L.Bounds=v,L.Color=j,L.Size=U,L.Vector=g,L.Event=f,L.Object2D=x,L.Styled=m,L.Audio=q,L.Camera=b,L.Renderer=P,L.Scene=k,L.Bow=J,L.Circle=Z,L.Ellipse=Q,L.Fan=tt,L.Line=V,L.Point=G,L.Polygon=it,L.Polyline=nt,L.Rectangle=st,L.Spline=rt,L.Triangle=et,L.Image=at,L.PointText=K,L.Animation=$,L.AnimationRunner=O,L.AnimationTask=N,L.DashFlowManager=F,L.SpriteSheet=ct,L.InputManager=T,L.MouseControl=dt,L.geometryAlgorithm=vt,L.ShapeRandomizer=mt,L.config=xt,L.version="0.5.0-wip";for(var bt=["d2r","rand","MOUSE","POINT_RENDER_SIZE"],kt=0;kt<bt.length;kt++){var Pt=bt[kt];L[Pt]=y[Pt]}var Tt=Date.now(),St=y.data("version.timestamp");return(!St||Tt-St>6e4)&&("function"==typeof console.info&&console.info("bu.js v"+L.version+" - [https://github.com/jarvisniu/bu.js]"),y.data("version.timestamp",Tt)),L}();